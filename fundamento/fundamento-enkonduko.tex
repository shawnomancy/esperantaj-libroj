%
% Preamble for the Fundamento and Ekzerca Libro
%

% de Google Fonts
\newfontfamily\brevefont[FakeSlant=1,FakeBold=3.0]{Old Standard TT}
\newfontfamily\stdfont{Old Standard TT}

\defaultfontfeatures{Scale=MatchLowercase}

% Fraktur bold
%
\newcommand{\frb}[1]{%
{\relsize{0}{\textbf{#1}}}}

% Switch back to antiqua in the middle of fraktur for E-o examples
%
\newcommand{\std}[1]{%
{\relsize{0}{\stdfont{#1}}}}

% fancy page headers, that is, in imitation of the original
%
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\renewcommand\headrule{}
\renewcommand\footrule{}

% fake small caps
%
\makeatletter
\newlength\fake@f
\newlength\fake@c
\def\fakesc#1{%
  \begingroup%
  \xdef\fake@name{\csname\curr@fontshape/\f@size\endcsname}%
  \fontsize{\fontdimen8\fake@name}{\baselineskip}\selectfont%
  \uppercase{#1}%
  \endgroup%
}
\makeatother
\newcommand\fauxsc[1]{\fauxschelper#1 \relax\relax}
\def\fauxschelper#1 #2\relax{%
  \fauxschelphelp#1\relax\relax%
  \if\relax#2\relax\else\ \fauxschelper#2\relax\fi%
}
\def\Hscale{.83}\def\Vscale{.72}\def\Cscale{1.00}
\def\fauxschelphelp#1#2\relax{%
  \ifnum`#1>``\ifnum`#1<`\{\scalebox{\Hscale}[\Vscale]{\uppercase{#1}}\else%
    \scalebox{\Cscale}[1]{#1}\fi\else\scalebox{\Cscale}[1]{#1}\fi%
  \ifx\relax#2\relax\else\fauxschelphelp#2\relax\fi}


% Small rules
%
\newcommand{\smallrule}{%
\begin{center}%
\rule{13mm}{0.4pt}\end{center}}

\newcommand{\flatsmallrule}{{\centering\rule[0.9ex]{13mm}{0.4pt}\par}}

% Esperanto text and morpheme dividers in the Russian grammar
%
\newcommand{\es}[1]{{{\textbf{#1}}}}
\renewcommand{\|}{$|$}

% Stretch bold.  Use for Russian bold words, and for titles in Latin-alphabet grammar sections.
%
\newcommand{\br}[1]{\scalebox{1.2}[1]{\textbf{#1}}}

% Vortaro headletters
\newcommand{\uvlitero}[1]{{\centering\vskip 1ex\LARGE\bookman{#1}\vskip 1ex\par}}

% Vortaro entries
\newcommand{\uventry}[1]{{\csfont{\textbf{#1}}}}

% Vortaro subentries
\newcommand{\uvsubentry}{\hspace{1em}}

% Spacing out or tightening letters
%
\sodef\spaceout{}{.2em}{0.6em}{0pt}
\sodef\spaceoutmed{}{.1em}{0.5em}{0pt}
\sodef\spaceoutless{}{.05em}{0.4em}{0pt}
\newcommand{\narrow}[1]{\scalebox{0.8}[1]{#1}}

% Grammar subsection headings (for the three that use 
% Antiqua letters; also in ekzercaro)
%
\newcommand{\gramsec}[1]{%
{\chunk{\textbf{\spaceoutless{#1}}}}}

% Ekzercaro section heading
%
\newcommand{\ekzsec}[1]{%
\begin{center}
\narrow{\large #1}
\end{center}}

% outdented paragraphs in ekzercaro
%
\newenvironment{ekzvocab}[1]
  {\setlength{\leftskip}{#1}%%
   \setlength{\parindent}{-#1}%%
   \vskip 1ex
     \footnotesize
  }
  {\par}
  
% wrapfig for the cj/nj definition
%
\usepackage{wrapfig}

%
% Handcrafted accents for the script letters in the Ekzercaro.
%

% dotless j -- need to remove the dot before we drop the circumflex on it!
%
\usepackage{stackengine}
\newcommand{\dotlessj}{\stackinset{c}{0.55ex}{b}{1.85ex}{\color{white}\rule{0.5ex}{0.5ex}}{j}}

% breve -- this font lacks a breve to use.  We defined a breve font
% above using FakeSlant to give it the desired slant to match our
% script U/u.
%
\newcommand{\scriptbreve}{\Large\brevefont{\u{}}}

% Now the letters.  If you use a different script font, you'll probably
% need to play with all these numbers. Or maybe you'll have one that
% just has the accents built in already!
%
\newcommand{\scriptC}{\stackinset{c}{0.2ex}{b}{0.05ex}{\^{}}{C}}
\newcommand{\scriptc}{\stackinset{c}{-0.8ex}{b}{-1.1ex}{\^{}}{c}}
\newcommand{\scriptG}{\stackinset{c}{0ex}{b}{0.05ex}{\^{}}{G}}
\newcommand{\scriptg}{\stackinset{c}{-1.1ex}{b}{-0.3ex}{\^{}}{g}}
\newcommand{\scriptH}{\stackinset{c}{0ex}{b}{0.05ex}{\^{}}{H}}
\newcommand{\scripth}{\stackinset{c}{-0.3ex}{b}{-0.05ex}{\^{}}{h}}
\newcommand{\scriptJ}{\stackinset{c}{0ex}{b}{0.6ex}{\^{}}{J}}
\newcommand{\scriptj}{\stackinset{c}{-1ex}{b}{-0.3ex}{\^{}}{\dotlessj}}
\newcommand{\scriptS}{\stackinset{c}{0.35ex}{b}{0.05ex}{\^{}}{S}}
\newcommand{\scripts}{\stackinset{c}{-0.9ex}{b}{-0.9ex}{\^{}}{s}}
\newcommand{\scriptU}{\stackinset{c}{0.25ex}{b}{1.2ex}{\scriptbreve}{U}}
\newcommand{\scriptu}{\stackinset{c}{-0.6ex}{b}{0ex}{\scriptbreve}{u}}

%
% End of preamble
%