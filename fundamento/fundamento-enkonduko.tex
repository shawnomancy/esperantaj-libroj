%
% Enkonduko por la Fundamento
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
% Tiparoj
%

% de Google Fonts
%
\newfontfamily\brevefont[FakeSlant=1,FakeBold=0.5]{Old Standard TT}
\newfontfamily\stdfont{Old Standard TT}

\defaultfontfeatures{Scale=MatchLowercase}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
% Editorial footnoting
%
%\usepackage[perpage]{footmisc}
\usepackage[perpage]{manyfoot}
\DeclareNewFootnote{E}[fnsymbol]
\newcommand\eraro[1]{\footnoteE{Ŝajnerare anstataŭ \emph{#1.}}}
\newcommand\unuakomon{\footnoteE{%
La unua eldono de la \emph{Ekzercaro} havis komon ĉi tie.}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
% Speciale por la germana gramatiko
%

% Fraktur bold
%
\newcommand{\frb}[1]{%
{\relsize{0}{\textbf{#1}}}}

% Switch back to antiqua in the middle of fraktur for E-o examples
%
\newcommand{\std}[1]{%
{\relsize{0}{\stdfont{#1}}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
% Speciale por la rusa gramatiko
%

% Esperanto text and morpheme dividers in the Russian grammar
\newcommand{\es}[1]{{{\textbf{#1}}}}
\renewcommand{\|}{$|$}

% Stretch bold.  Use for Russian bold words, and for titles
% in Latin-alphabet grammar sections.
\newcommand{\br}[1]{\scalebox{1.2}[1]{\textbf{#1}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
% Speciale por la Ekzercaro
%

% Ekzercaro section headings
%
\newcommand{\myTempSubsect}{\ldots}
\newcommand{\ekzsec}[2][]{%
\begin{center}
\phantomsection
\narrow{\large #2}
{\ifthenelse{\equal{#1}{}}{}{\vskip 1ex
{#1}}}
\end{center}
{\ifthenelse{\equal{#1}{}}{%
\addcontentsline{toc}{section}{#2}}{%
\renewcommand{\myTempSubsect}{#1}
\xpatchcmd*{\myTempSubsect}{1ex}{}{}{}
\addcontentsline{toc}{section}{#2 \myTempSubsect}}
}}

% outdented paragraphs in ekzercaro
%
\newenvironment{ekzvocab}[1]
  {\setlength{\leftskip}{#1}%%
   \setlength{\parindent}{-#1}%%
   \vskip 1ex
     \footnotesize
  }
  {\par}

%
% Handcrafted accents for the script letters in the Ekzercaro.
%

% dotless j -- need to remove the dot before we drop the circumflex on it!
%
\usepackage{stackengine}
\newcommand{\dotlessj}{ȷ}

% breve -- this font lacks a breve to use.  We defined a breve font
% above using FakeSlant to give it the desired slant to match our
% script U/u.
%
\newcommand{\scriptbreve}{\Large\brevefont{\u{}}}

% Now the letters.  If you use a different script font, you'll probably
% need to play with all these numbers. Or maybe you'll have one that
% just has the accents built in already!
%
\newcommand{\scriptC}{\stackinset{c}{2ex}{t}{-1ex}{ˆ}{C}}
\newcommand{\scriptc}{\stackinset{c}{0.8ex}{b}{0.1ex}{ˆ}{c}}
\newcommand{\scriptG}{\stackinset{c}{2.1ex}{t}{-1.1ex}{ˆ}{G}}
\newcommand{\scriptg}{\stackinset{c}{0.9ex}{b}{2.1ex}{ˆ}{g}}
\newcommand{\scriptH}{\stackinset{c}{2.2ex}{t}{-1.1ex}{ˆ}{H}}
\newcommand{\scripth}{\stackinset{c}{2ex}{t}{-1.1ex}{ˆ}{h}}
\newcommand{\scriptJ}{\stackinset{c}{2.4ex}{t}{-1.2ex}{ˆ}{J}}
\newcommand{\scriptj}{\stackinset{c}{0.9ex}{b}{2.1ex}{ˆ}{\dotlessj}}
\newcommand{\scriptS}{\stackinset{c}{2.5ex}{t}{-1.3ex}{ˆ}{S}}
\newcommand{\scripts}{\stackinset{c}{0.9ex}{b}{0.5ex}{ˆ}{s}}
\newcommand{\scriptU}{\stackinset{c}{-0.3ex}{t}{-0.7ex}{\scriptbreve}{U}}
\newcommand{\scriptu}{\stackinset{l}{-1ex}{b}{0ex}{\scriptbreve}{u}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
% Speciale por la Universala Vortaro
%

% Vortaro headletters
\newcommand{\uvlitero}[1]{%
\phantomsection
{\centering\vskip 1ex\LARGE\bookman{#1}\vskip 1ex\par}
\addcontentsline{toc}{section}{#1}
}

% Vortaro entries
\newcommand{\uventry}[1]{{\csfont{\textbf{#1}}}}

% Vortaro subentries
\newcommand{\uvsubentry}{\hspace{1em}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% fancy page headers, that is, in imitation of the original
%
\renewcommand\headrule{}
\renewcommand\footrule{}

% fake small caps
%
\makeatletter
\newlength\fake@f
\newlength\fake@c
\def\fakesc#1{%
  \begingroup%
  \xdef\fake@name{\csname\curr@fontshape/\f@size\endcsname}%
  \fontsize{\fontdimen8\fake@name}{\baselineskip}\selectfont%
  \uppercase{#1}%
  \endgroup%
}
\makeatother
\newcommand\fauxsc[1]{\fauxschelper#1 \relax\relax}
\def\fauxschelper#1 #2\relax{%
  \fauxschelphelp#1\relax\relax%
  \if\relax#2\relax\else\ \fauxschelper#2\relax\fi%
}
\def\Hscale{.83}\def\Vscale{.72}\def\Cscale{1.00}
\def\fauxschelphelp#1#2\relax{%
  \ifnum`#1>``\ifnum`#1<`\{\scalebox{\Hscale}[\Vscale]{\uppercase{#1}}\else%
    \scalebox{\Cscale}[1]{#1}\fi\else\scalebox{\Cscale}[1]{#1}\fi%
  \ifx\relax#2\relax\else\fauxschelphelp#2\relax\fi}


% Small rules
\newcommand{\smallrule}{%
\begin{center}%
\rule{13mm}{0.4pt}\end{center}}

\newcommand{\flatsmallrule}{{\centering\rule[0.9ex]{13mm}{0.4pt}\par}}

% Grammar subsection headings (for the three that use 
% Antiqua letters; also in ekzercaro)
%
\newcommand{\gramsec}[1]{{\chunk{\br{#1}}}}

% wrapfig for the cj/nj definition
%
\usepackage{wrapfig}

% titlesec -- better section/chapter headings
%
% memoru:
% titleformat{command}[shape]{format}{label}{sep}{before-code}[after-code]
%

\titleclass{\chapter}{straight}
\renewcommand{\thesection}{\arabic{section}}
\titleformat{\section}[display]{\centering\large\bf}{}{0pt}{\phantomsection\scalebox{2}[1]}
\titlespacing{\section}{0pt}{1em}{1em}

\titleformat{\chapter}[display]{\centering}{}{0pt}{\Large\bookman}
\titlespacing{\chapter}{0pt}{1em}{1em}

\newcommand\mychap[1]{%
\phantomsection
\chapter*{#1}
\addcontentsline{toc}{chapter}{#1}
}


\newcommand\mychapbig[1]{%
\phantomsection
\chapter*{\protect\scalebox{2}[1]{#1}}
\addcontentsline{toc}{chapter}{#1}
}

\newcommand\mysect[1]{%
\section*{#1}
\addcontentsline{toc}{section}{#1}
}

%
% End of preamble
%
